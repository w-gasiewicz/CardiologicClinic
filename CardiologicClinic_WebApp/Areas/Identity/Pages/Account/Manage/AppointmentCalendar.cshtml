@page
@model AppointmentCalendarModel
@inject UserManager<ApplicationUser> UserManager
@using  CardiologicClinic_WebApp.Models;
@{
    ViewData["Title"] = "Kalendarz wizyt";
    ViewData["ActivePage"] = ManageNavPages.AppointmentCalendar;
    AppointmentCalendarModel acm = new AppointmentCalendarModel(UserManager);
    var visits = Model.GetUsersVisitAsync().Result;
    var schedulerEvents = Model.FillCalendar(visits);
}

<h4>@ViewData["Title"]</h4>

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <script src="https://cdn.dhtmlx.com/scheduler/edge/dhtmlxscheduler.js"></script>
    <script src="codebase/ext/dhtmlxscheduler_pdf.js"></script>
    <link href="https://cdn.dhtmlx.com/scheduler/edge/dhtmlxscheduler_material.css"
          rel="stylesheet" type="text/css" charset="utf-8">
    <style>
        html, body {
            margin: 20px;
            padding: 0px;
        }
    </style>
</head>
<body>
    <div id="scheduler_here" class="dhx_cal_container" style='width:100%; height:80vh;'>
        <div class="dhx_cal_navline">
            <div class="dhx_cal_prev_button">&nbsp;</div>
            <div class="dhx_cal_next_button">&nbsp;</div>
            <div class="dhx_cal_today_button"></div>
            <div class="dhx_cal_date"></div>
            <div class="dhx_cal_tab" name="day_tab"></div>
            <div class="dhx_cal_tab" name="week_tab"></div>
            <div class="dhx_cal_tab" name="month_tab"></div>
        </div>
        <div class="dhx_cal_header"></div>
        <div class="dhx_cal_data"></div>
    </div>
    <script type="text/javascript">
        scheduler.config.readonly = true;
        scheduler.config.show_loading = true;
        scheduler.config.data_format = "MM/dd/yyyy hh:mm";

        scheduler.locale = {
            date: {
                month_full: ["Styczeń", "Luty", "Marzec", "Kwiecień", "Maj", "Czerwiec", "Lipiec", "Sierpień", "Wrzesień", "Październik", "Listopad", "Grudzień"],
                month_short: ["Sty", "Lut", "Mar", "Kwi", "Maj", "Jun", "Lip", "Sie", "Wrz", "Paź", "Lis", "Gru"],
                day_full: ["Niedziela", "Poniedziałek", "Wtorek", "Środa", "Czwartek", "Piątek", "Sobota"],
                day_short: ["Nie", "Pon", "Wt", "Śr", "Czw", "Pią", "Sob"]
            },
            labels: {
                dhx_cal_today_button: "Dziś",
                day_tab: "Dzień",
                week_tab: "Tydzień",
                month_tab: "Miesiąc",
                new_event: "Nowa wizyta",
                icon_save: "Zapisz",
                icon_cancel: "Anuluj",
                icon_details: "Szczegóły",
                icon_edit: "Edytuj",
                icon_delete: "Usuń",
                confirm_closing: "Zmiany zostaną utracone, czy jesteś pewny?", //Your changes will be lost, are your sure?
                confirm_deleting: "Wizyta zostanie trwale usunięta, czy jesteś pewny?",
                section_description: "Opis",
                section_time: "Okres czasu"
            }
        }
        scheduler.init('scheduler_here', new Date(2019, 08, 09), "week");

        @foreach (var myevent in schedulerEvents)
        {
        <text>
        scheduler.addEvent({
            start_date:"@Html.Raw(System.Web.HttpUtility.JavaScriptStringEncode(myevent.start_date))",
            end_date: "@Html.Raw(System.Web.HttpUtility.JavaScriptStringEncode(myevent.end_date))",
            text: "@Html.Raw(System.Web.HttpUtility.JavaScriptStringEncode(myevent.text))"
            });
        </text>
        }

    </script>
</body>
</html>
